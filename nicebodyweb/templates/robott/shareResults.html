<!DOCTYPE HTML>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta property="og:title" content="Niceå·´åº•æ¨è–¦ï¼è¼•é¬†æ‰“é€ å¥åº·ç¾å‘³çš„ä¸€é¤">
		<meta property="og:description" content="é‚„åœ¨ç…©æƒ±ä»Šå¤©åˆé¤è¦åƒä»€éº¼å—ï¼Ÿâœ¨\nåˆ¥æ“”å¿ƒï¼Œæˆ‘å·²ç¶“åœ¨ Niceå·´åº• æº–å‚™å¥½äº†ä¸€é“å…¨æ–°çš„å¥åº·é£Ÿè­œï¼ğŸ½ï¸\n\nä¸åƒ…ç¾å‘³ï¼Œè£½ä½œèµ·ä¾†ä¹Ÿè¶…ç°¡å–®ï¼Œ\nè®“ä½ è¼•é¬†äº«å—å¥åº·æ–°ç”Ÿæ´»ï¼\n\nå¿«ä¾†æŒ‘æˆ°é€™å€‹æ–™ç†ï¼Œè®“ä½ çš„å‘³è•¾å¤§å‘¼éç™®ï¼(à¸‡ â€¢Ì€_â€¢Ì)à¸‡ğŸ’ª\né‚„æœ‰æ›´å¤šé©šå–œç­‰è‘—ä½ å–”ï½é¦¬ä¸Šä¾†è©¦è©¦å§ï¼ğŸ¥¦ğŸ…\n\n#ç¾å‘³é£Ÿè­œ #å¥åº·ç”Ÿæ´» #è¼•é¬†æ–™ç†">
		<link href="/static/images/favicon.ico" rel="shortcut icon"/>
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500&display=swap" rel="stylesheet">
		<link rel="stylesheet" href="/static/css/base/reset.css">
		<link rel="stylesheet" href="/static/css/base/global.css">
		<link rel="stylesheet" href="/static/css/components/mousemove.css">
		<link rel="stylesheet" href="/static/css/components/dialog.css">
		<link rel="stylesheet" href="/static/css/layout/navbar.css">
		<link rel="stylesheet" href="/static/css/layout/footer.css">
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		<link rel="stylesheet" href="/static/css/robott/shareResults.css">
		<link rel="stylesheet" href="/static/css/components/carousel.css">
		<link rel="stylesheet" href="/static/css/components/fancybox/jquery.fancybox.css"/>
		<link rel="stylesheet" href="/static/css/components/fancybox/my.jquery.fancybox.css"/>
		<link rel="stylesheet" href="/static/css/components/dialog.css">
		<script src="https://kit.fontawesome.com/d9f27795c1.js" crossorigin="anonymous"></script>
		<script src="/static/components/mousemove.js" defer></script>
		<script src="/static/components/layout/navbar.js" defer></script>
		<script src="/static/components/layout/footer.js" defer></script>
		<script src="/static/components/jquery.fancybox.js"></script> 
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
		<title>é£Ÿè­œå¤©åœ° > è©³ç´°é£Ÿè­œ</title>
	</head>

	<body>
		<div id="myCursor"></div>
		<div id="circle"></div>

		<nav id="nav-container"></nav>

		<article>
			<div class="banner">
				<a data-fancybox="gallery" href="{{ Recipes_image_path }}/{{ data[7] }}">
					<img src="{{ Recipes_image_path }}/{{ data[7] }}" alt="">
				</a>
			</div>

			<section class="receipe">
				<div class="sidetitle" id="sidetitle">
					<a href="/robott/recipeWorld">é£Ÿè­œå¤©åœ°</a>
					<i class="fa-solid fa-caret-down"></i>
					<p>{{data[0]}}</p>
				</div>
				<div class="wrap">
					<div class="title">
						<div class="left">
							<h1>{{data[0]}}</h1>
							<div class="like" id="like-button">
								{% if data[12] != 0 %}
									<i class="fa-solid fa-thumbs-up"></i>
								{% else %}
									<i class="fa-regular fa-thumbs-up"></i>
								{% endif %}
								<span>{{data[13]}}&ensp;</span>
							</div>
							<div class="receiperate">
								{% if data[12] == 1 %}
									<i class="fa-solid fa-star"></i>
								{% else %}
									<i class="fa-regular fa-star"></i>
								{% endif %}
								<span>{{data[15]}}</span>
							</div>
							<div class="bookmark">
								{% if has_non_zero %}
									<i class="fa-solid fa-bookmark" id="opencollect"></i>
								{% else %}
									<i class="fa-regular fa-bookmark" id="opencollect"></i>
								{% endif %}
							</div>
							<dialog id="collect">
								<h1>ç·¨è¼¯åˆ†é¡</h1>
								<div class="content">
									{% for d in data3 %}
									<div class="eachclass">
										<div class="left">
											<input type="checkbox" id="scales" name="scales" {% if d[2] != 0 %}checked{% endif %} />
											<label for="scales" data-id="{{ d[0] }}">{{ d[1] }}</label>
										</div>
										<div class="num">({{ d[3] }}ç¯‡)</div>
									</div>
									{% endfor %}
								</div>
								<div class="save">
									<button id="closecollect" class="closebtn closecollect">close</button>
									<button id="savecollect" class="savebtn savecollect">save</button>
								</div>
							</dialog>
						</div>
						<div class="diet" id="openinfor">
							{% if data[8] is not none %}
								{% if '1' in data[8] %}
									<span class="dietname mediterranean">åœ°ä¸­æµ·</span>
								{% endif %}
								{% if '2' in data[8] %}
									<span class="dietname deshu">å¾—èˆ’</span>
								{% endif %}
								{% if '3' in data[8] %}
									<span class="dietname vegetarian">å½ˆæ€§ç´ é£Ÿ</span>
								{% endif %}
								{% if '4' in data[8] %}
									<span class="dietname numdiet">234</span>
								{% endif %}
							{% endif %}
						</div>
						<dialog id="infor">
							<h1>é£²é£Ÿæ³•ç°¡ä»‹</h1>
							<div class="content">
								<h2>åœ°ä¸­æµ·é£²é£Ÿæ³•</h2>
								<p>ä»¥è”¬èœã€æ°´æœã€æ©„æ¬–æ²¹ã€é­šé¡å’Œå…¨ç©€é›œç³§ç‚ºä¸»ï¼Œå¼·èª¿æ–°é®®ã€å¤©ç„¶çš„é£Ÿæã€‚</p>
								<h2>å¾—èˆ’é£²é£Ÿæ³•</h2>
								<p>è‘—é‡é£Ÿç”¨å¤§é‡çš„è”¬èœå’Œæ°´æœï¼Œé™åˆ¶æˆ–é¿å…å‹•ç‰©æ€§é£Ÿå“å’ŒåŠ å·¥é£Ÿå“çš„æ”å…¥ï¼Œæ˜¯ä¸€å€‹é™ä½è¡€å£“é£²é£Ÿæ²»ç™‚æ–¹æ³•ã€‚</p>
								<h2>å½ˆæ€§ç´ é£Ÿ</h2>
								<p>çµåˆäº†ç´ é£Ÿå’Œéç´ é£Ÿçš„å…ƒç´ ï¼Œä»¥æ¤ç‰©æ€§é£Ÿç‰©ç‚ºä¸»ï¼Œä½†å…è¨±å¶çˆ¾é£Ÿç”¨å°‘é‡çš„å‹•ç‰©æ€§é£Ÿç‰©ã€‚</p>
								<h2>234é£²é£Ÿæ³•</h2>
								<p>ä»¥æ¯é¤æ”å…¥500å¡è·¯é‡Œç‚ºåŸå‰‡ï¼Œæ”å–çš„ç‡Ÿé¤Šæ¯”ä¾‹ç‚ºï¼šè›‹ç™½è³ªä½”25%ã€æ¾±ç²‰ä½”35%ã€è„‚è‚ªä½”40%ã€‚</p>
							</div>
							<div class="save">
								<button id="closeinfor" class="closebtn">close</button>
							</div>
						</dialog>
					</div>
				
					<div class="summary">
						<p>{{data[1]}}</p>
						<h2>æ‘˜è¦</h2>
						<p>{{data[2]}}</p>
					</div>
						
					<div class="content">
						<h2>é£Ÿæé ç®— - {{data[9]}}å…ƒ</h2>
						<ol>
							{% for item in data[3].split(', ') %}
							<li>{{ item }}</li>
							{% endfor %}
						</ol>

						<h2>çƒ¹èª¿æ™‚é–“</h2>
						<p>{{data[4]}}åˆ†</p>

						<h2>
							æ–™ç†æ­¥é©Ÿ
							{% if data[10] > 162 %}
							<audio controls>
								<source src="/static/mp3/{{ data[11] }}/{{ data[16] }}" type="audio/mpeg">
								æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´éŸ³é »æ’­æ”¾ã€‚
							</audio>
							{% endif %}
						</h2>
						<ol>
							{% for item in data[5].split(', ') %}
							<li>{{ item }}</li>
							{% endfor %}
						</ol>

						<h2>ç‡Ÿé¤Šé…æ¯”</h2>
						<div class="chart-container">
							<p>{{data[6]}}</p>
							{% if data[10] > 134 %}
								<canvas id="nutritionChart"></canvas>
							{% endif %}
						</div>
					</div>
				</div>
			</section>

			<section class="sharebtns">
				<h2>åˆ†äº«ä½ çš„å‰µæ„é£Ÿè­œ</h2>
				<div class="links">
					<button id="fa-facebook"><i class="fa-brands fa-facebook"></i></button>
					<button id="twitter"><i class="fa-brands fa-square-x-twitter"></i></button>
				</div>
			</section>

			
			<section class="carousel related-carousel">
				<div class="reel">
					{% for d in recipe_data %}
					<div class="food">
						<form action="/robott/shareResults" method="get">
							<input type="hidden" name="recipe_id" value="{{ d[2] }}">
							<button type="submit" class="image featured">
								<img src="{{ Recipes_image_path }}/{{ d[0] }}" alt="">
								<h3>{{ d[1] }}</h3>
							</button>
						</form>
					</div>
					{% endfor %}
				</div>
			</section>

			<section class="comment">
				<div class="wrap">
					<div class="title">
						<div class="left">
							<h1>å¤§å®¶ä¸€èµ·åš</h1>
							<div class="share">
								<i class="fa-solid fa-comments"></i>
								<span>{{data[14]}}</span>
							</div>
						</div>
					</div>

					<div class="message">
						<div class="left">
							<div class="evaluaterate">
								<h3>é£Ÿè­œå“è³ª</h3>
								<i class="fa-solid fa-star"></i>
								<select name="" id="star">
									<option value="0">0</option>
									<option value="0.5">0.5</option>
									<option value="1">1</option>
									<option value="1.5">1.5</option>
									<option value="2">2</option>
									<option value="2.5">2.5</option>
									<option value="3">3</option>
									<option value="3.5">3.5</option>
									<option value="4">4</option>
									<option value="4.5">4.5</option>
									<option value="5">5</option>
								</select>
							</div>
							<input type="text" id="messageInput" placeholder="èªªé»ä»€éº¼å§ï¼">
						</div>
						<button id="submitButton" class="submitButton"><i class="fa-solid fa-paper-plane"></i></button>
					</div>

					{% for d in data2%}
						<a class="each">
							<div class="left">
								<div class="receiperate">
									<i class="fa-solid fa-star"></i>
									<span>{{d[5]}}</span>
								</div>
								<p>{{d[4]}}</p>
							</div>
							<div class="right">
								<p>{{d[6]}}</p>
								<img class="photostickers" src="{{ user_image_path }}/{{ d[1] }}/{{ d[2] }}" alt="">
							</div>
						</a>
					{% endfor %}
				</div>
			</section>

			<dialog id="loginDialog">
				<h1>è«‹å…ˆç™»å…¥</h1>
				<div class="contentsave">
				  <button class="savebtn" onclick="window.location.href='/login/loginPage'">login</button>
				</div>
			</dialog>
		</article>

		<footer id="footer-container"></footer>

		<script src="/static/js/jquery.scrollex.min.js"></script>
		<script>
			let messageText = "{{name}}";
			let userImage = "{{userImage}}"
			let uid = "{{uid}}"

			window.onload = function() {
				renderNav();
				renderFooter();
				renderChart();

				if (messageText == "0") {
					document.getElementById("loginDialog").showModal();
					document.getElementById("loginDialog").scrollTop = 0;
				}
			};

			function showModal() {
				document.getElementById("loginModal").style.display = "flex";
			}

			function renderChart() {
				var nutritionData = "{{data[6]}}".split(', ').map(function(item) {
					var parts = item.match(/(\D+)(\d+)%/);
					return {
						label: parts[1],
						value: parseInt(parts[2])
					};
				});

				// é¡è‰²æ˜ å°„è¡¨ï¼Œå°æ‡‰æ¯å€‹æ¨™ç±¤
				var colorMap = {
					'è›‹ç™½è³ª': '#efebce', 
					'çº–ç¶­': '#C1CCC7', 
					'ç¶­ç”Ÿç´ C': '#E4B69E', 
					'ç¤¦ç‰©è³ª': '#A98978', 
					'æ¾±ç²‰': '#BFD1C4',
					'è„‚è‚ª': '#a3a380',
					'ç³–': '#B3CAD8',
					'æ¾±ç²‰':'#DBB89C',
					'ç¢³æ°´åŒ–åˆç‰©':'#d6ce93',
					'çº–ç¶­ç´ ': '#D3AC73',
					'éˆ‰': '#D09075',
					'å…¶ä»–': '#F1D09D',
					'ç¶­ç”Ÿç´ èˆ‡ç¤¦ç‰©è³ª': '#F4D4BE',
					'ç¶­ç”Ÿç´ ': '#CEA77E',
				};

				var labels = nutritionData.map(function(item) {
					return item.label;
				});

				var data = nutritionData.map(function(item) {
					return item.value;
				});

				// ç‚ºæ¯å€‹æ¨™ç±¤åˆ†é…é¡è‰²
				var backgroundColor = labels.map(function(label) {
					return colorMap[label] || '#d8a48f'; // é»˜èªé¡è‰²ç‚ºé»‘è‰²
				});

				var borderColor = backgroundColor; // ä½¿ç”¨ç›¸åŒçš„é‚Šæ¡†é¡è‰²

				var ctx = document.getElementById('nutritionChart').getContext('2d');
				var chart = new Chart(ctx, {
					type: 'pie',
					data: {
						labels: labels,
						datasets: [{
							label: 'ç‡Ÿé¤Šé…æ¯”',
							data: data,
							backgroundColor: backgroundColor,
							borderColor: borderColor,
							borderWidth: 1
						}]
					},
					options: {
						responsive: false,
						maintainAspectRatio: false,
						plugins: {
							legend: {
								position: 'top',
								onClick: function(e, legendItem, legend) {
									e.stopPropagation(); // é˜»æ­¢é»æ“Šäº‹ä»¶
								}
							},
							title: {
								display: false,
								text: 'ç‡Ÿé¤Šé…æ¯”'
							}
						}
					}
				});
			}

			// å½ˆè·³è¦–çª— é£²é£Ÿæ³•ç°¡ä»‹
			let openinfor=document.getElementById('openinfor');
			let infor=document.getElementById('infor');
			let closeinfor=document.getElementById('closeinfor');
			openinfor.addEventListener("click", function(){
				infor.showModal();
				infor.scrollTop = 0;
			})
			closeinfor.addEventListener("click", function(){
				infor.close();
			})

			// æŒ‰è®š
			document.addEventListener('DOMContentLoaded', function() {
				const likeButton = document.getElementById('like-button');
				const likeIcon = likeButton.querySelector('i');
				const likeCountSpan = likeButton.querySelector('span');
				let likeCount = parseInt(likeCountSpan.textContent);

				likeButton.addEventListener('click', function() {
					if (likeIcon.classList.contains('fa-regular')) {
						$.ajax({
							type: "POST",
							url: "/robott/likeAdd",
							data: {
								recipe_id: "{{ data[10] }}"
							},
							success: function(response) {
								console.log(response);
							},
							error: function(xhr, status, error) {
								console.error(error);
								//alert(error, 'å‡ºç¾éŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ï¼');
							}
						});

						likeIcon.classList.remove('fa-regular');
						likeIcon.classList.add('fa-solid', 'liked');
						likeCount++;
					} else {
						$.ajax({
							type: "POST",
							url: "/robott/likeSub",
							data: {
								recipe_id: "{{ data[10] }}"
							},
							success: function(response) {
								console.log(response);
							},
							error: function(xhr, status, error) {
								console.error(error);
								//alert(error, 'å‡ºç¾éŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ï¼');
							}
						});

						likeIcon.classList.remove('fa-solid', 'liked');
						likeIcon.classList.add('fa-regular');
						likeCount--;
					}
					likeCountSpan.textContent = likeCount;
				});
			});

			// ç•™è¨€
			document.addEventListener('DOMContentLoaded', function() {
				const messageInput = document.getElementById('messageInput');
				const submitButton = document.getElementById('submitButton');
				const star = document.getElementById('star');

				submitButton.addEventListener('click', function() {
					const message = messageInput.value;
					const starValue = star.value;
					if (message === '') {
						alert('è«‹è¼¸å…¥ç•™è¨€');
						return;
					}

					$.ajax({
						type: "POST",
						url: "/robott/comment",
						data: {
							recipe_id: "{{ data[10] }}",
							message: message,
							star: starValue
						},
						success: function(response) {
							console.log(response);
						},
						error: function(xhr, status, error) {
							console.error(error);
							alert(error, 'å‡ºç¾éŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ï¼');
						}
					});

					// æ¸…ç©º messageInput ä¸¦å°‡ star è¨­ç‚º 0
					messageInput.value = '';
					star.value = 0;

					// å–å¾—ç¾åœ¨çš„æ—¥æœŸ
					const today = new Date();
					const formattedDate = ('0' + (today.getMonth() + 1)).slice(-2) + '.' + 
						('0' + today.getDate()).slice(-2) + '.' + 
						today.getFullYear();

					// æ–°å¢ç•™è¨€åˆ° .each å…ƒç´ ä¸­
					const newMessage = document.createElement('a');
					newMessage.classList.add('each');
					newMessage.innerHTML = `
						<div class="left">
							<div class="receiperate">
								<i class="fa-solid fa-star"></i>
								<span>${starValue}</span>
							</div>
							<p>${message}</p>
						</div>
						<div class="right">
							<p>${formattedDate}</p>
							<img class="photostickers" src="/static/images/userImage/${uid}/${userImage}" alt="">
						</div>
					`;
					const firstEach = document.querySelector('.each');
					if (firstEach) {
						firstEach.parentNode.insertBefore(newMessage, firstEach);
					} else {
						document.querySelector('.comment .wrap').appendChild(newMessage);
					}
				});
			});

			// åˆ†äº«
			document.addEventListener('DOMContentLoaded', function() {
				const facebookButton = document.getElementById('fa-facebook');
				const twitterButton = document.getElementById('twitter');

				const shareText = encodeURIComponent("é‚„åœ¨ç…©æƒ±ä»Šå¤©åˆé¤è¦åƒä»€éº¼å—ï¼Ÿâœ¨\nåˆ¥æ“”å¿ƒï¼Œæˆ‘å·²ç¶“åœ¨ Niceå·´åº• æº–å‚™å¥½äº†ä¸€é“å…¨æ–°çš„å¥åº·é£Ÿè­œï¼ğŸ½ï¸\n\nä¸åƒ…ç¾å‘³ï¼Œè£½ä½œèµ·ä¾†ä¹Ÿè¶…ç°¡å–®ï¼Œ\nè®“ä½ è¼•é¬†äº«å—å¥åº·æ–°ç”Ÿæ´»ï¼\n\nå¿«ä¾†æŒ‘æˆ°é€™å€‹æ–™ç†ï¼Œè®“ä½ çš„å‘³è•¾å¤§å‘¼éç™®ï¼(à¸‡ â€¢Ì€_â€¢Ì)à¸‡ğŸ’ª\né‚„æœ‰æ›´å¤šé©šå–œç­‰è‘—ä½ å–”ï½é¦¬ä¸Šä¾†è©¦è©¦å§ï¼ğŸ¥¦ğŸ…\n\n#ç¾å‘³é£Ÿè­œ #å¥åº·ç”Ÿæ´» #è¼•é¬†æ–™ç†");
				const shareText2 = encodeURIComponent("é‚„åœ¨ç…©æƒ±ä»Šå¤©åˆé¤è¦åƒä»€éº¼å—ï¼Ÿâœ¨\nåˆ¥æ“”å¿ƒï¼Œæˆ‘å·²ç¶“åœ¨ Niceå·´åº• æº–å‚™å¥½äº†ä¸€é“å…¨æ–°çš„å¥åº·é£Ÿè­œï¼ğŸ½ï¸\n\nå¿«ä¾†æŒ‘æˆ°é€™å€‹æ–™ç†ï¼Œè®“ä½ çš„å‘³è•¾å¤§å‘¼éç™®ï¼(à¸‡ â€¢Ì€_â€¢Ì)à¸‡ğŸ’ª\né‚„æœ‰æ›´å¤šé©šå–œç­‰è‘—ä½ å–”ï½é¦¬ä¸Šä¾†è©¦è©¦å§ï¼ğŸ¥¦ğŸ…\n\n#ç¾å‘³é£Ÿè­œ #å¥åº·ç”Ÿæ´» #è¼•é¬†æ–™ç†");

				facebookButton.addEventListener('click', function() {
					window.open('https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(window.location.href), '_blank');
				});

				twitterButton.addEventListener('click', function() {
					window.open('https://twitter.com/intent/tweet?url=' + window.location.href + '&text=' + shareText2, '_blank');
				});
			});

			// æ”¶è—
			document.addEventListener('DOMContentLoaded', function() {
				const collect = document.getElementById('collect');
				const openCollectButton = document.getElementById('opencollect');
				const saveCollectButton = document.getElementById('savecollect');
				const closeCollectButton = document.getElementById('closecollect');
				const bookmarkIcon = document.getElementById('opencollect');

				let oldSelect = [];
				let newSelect = [];

				// ç•¶æ‰“é–‹ dialog æ™‚ï¼Œè¨˜éŒ„ç•¶å‰çš„å‹¾é¸ç‹€æ…‹
				openCollectButton.addEventListener('click', function() {
					collect.showModal();
					collect.scrollTop = 0;
					// æ¸…ç©º previous selections
					oldSelect = [];
					document.querySelectorAll('#collect .eachclass input[type="checkbox"]').forEach(checkbox => {
						if (checkbox.checked) {
							oldSelect.push(checkbox.parentElement.querySelector('label').textContent);
						}
					});
				});

				// ç•¶é»æ“Š save æŒ‰éˆ•æ™‚ï¼ŒåŸ·è¡Œä»¥ä¸‹æ“ä½œ
				saveCollectButton.addEventListener('click', function() {
					newSelect = [];
					const itemsToUpdate = {};

					document.querySelectorAll('#collect .eachclass input[type="checkbox"]').forEach(checkbox => {
						const label = checkbox.parentElement.querySelector('label').textContent;
						if (checkbox.checked) {
							newSelect.push(label);
							// è¨˜éŒ„éœ€è¦å¢åŠ è¨ˆæ•¸çš„é …ç›®
							itemsToUpdate[label] = (itemsToUpdate[label] || 0) + 1;
						}
					});

					const addedItems = newSelect.filter(item => !oldSelect.includes(item));
					const removedItems = oldSelect.filter(item => !newSelect.includes(item));

					console.log('addedItems', addedItems);
					console.log('removedItems', removedItems);

					// æ›´æ–°æ”¶è—ç¬¦è™Ÿçš„æ¨£å¼
					if (newSelect.length > 0) {
						bookmarkIcon.classList.remove('fa-regular');
						bookmarkIcon.classList.add('fa-solid');
					} else {
						bookmarkIcon.classList.remove('fa-solid');
						bookmarkIcon.classList.add('fa-regular');
					}

					// æ›´æ–° num æ•¸å­—
					addedItems.forEach(item => {
						const numElement = Array.from(document.querySelectorAll('#collect .eachclass'))
							.find(div => div.querySelector('label').textContent === item)
							.querySelector('.num');
						const currentCount = parseInt(numElement.textContent.match(/\d+/)[0]);
						numElement.textContent = `(${currentCount + 1}ç¯‡)`;

						$.ajax({
							type: "POST",
							url: "/robott/addCollect",
							data: {
								recipe_id: "{{ data[10] }}",
								category_id: numElement.previousElementSibling.querySelector('label').dataset.id
							},
							success: function(response) {
								console.log(response);
							},
							error: function(xhr, status, error) {
								console.error(error);
								//alert(error, 'å‡ºç¾éŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ï¼');
							}
						});
					});

					removedItems.forEach(item => {
						const numElement = Array.from(document.querySelectorAll('#collect .eachclass'))
							.find(div => div.querySelector('label').textContent === item)
							.querySelector('.num');
						const currentCount = parseInt(numElement.textContent.match(/\d+/)[0]);
						numElement.textContent = `(${currentCount - 1}ç¯‡)`;

						console.log(numElement.previousElementSibling.querySelector('label').dataset.id);
						console.log("{{ data[10] }}");

						$.ajax({
							type: "POST",
							url: "/robott/subCollect",
							data: {
								recipe_id: "{{ data[10] }}",
								category_id: numElement.previousElementSibling.querySelector('label').dataset.id
							},
							success: function(response) {
								console.log(response);
							},
							error: function(xhr, status, error) {
								console.error(error);
								//alert(error, 'å‡ºç¾éŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ï¼');
							}
						});
					});

					collect.close();
				});

				// ç•¶é—œé–‰ dialog æ™‚ï¼Œä¿ç•™å‹¾é¸ç‹€æ…‹
				closeCollectButton.addEventListener('click', function() {
					collect.close();
				});
			});
		</script>
	</body>
</html>